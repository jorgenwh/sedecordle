rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    // Leaderboard collection rules
    match /leaderboard/{document} {
      // Anyone can read the leaderboard
      allow read: if true;

      // Anyone can create a new score entry
      allow create: if request.resource.data.keys().hasAll([
        'playerName', 'attempts', 'timeSeconds', 'completedAt', 'targetWords'
      ]) &&
      request.resource.data.playerName is string &&
      request.resource.data.playerName.size() > 0 &&
      request.resource.data.playerName.size() <= 50 &&
      request.resource.data.attempts is int &&
      request.resource.data.attempts >= 1 &&
      request.resource.data.attempts <= 21 &&
      request.resource.data.timeSeconds is int &&
      request.resource.data.timeSeconds > 0 &&
      request.resource.data.timeSeconds < 86400 && // Less than 24 hours
      request.resource.data.completedAt is timestamp &&
      request.resource.data.targetWords is list &&
      request.resource.data.targetWords.size() == 16;

      // No one can update or delete existing scores
      allow update: if false;
      allow delete: if false;
    }
  }
}